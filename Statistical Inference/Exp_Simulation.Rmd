---
title: "Exponential Distribution Simulation"
author: "Emmanuel Okyere Darko"
date: "3/26/2021"
output: statsr:::statswithr_lab
---

In this project I will investigate the exponential distribution in R and compare it with the Central Limit Theorem. The exponential distribution can be simulated in R with rexp(n, lambda) where lambda is the rate parameter. The rate used in this project is lambda = `0.2`. A 1000 simulations each of sample size 40 would be investigated. The mean of exponential distribution is 1/lambda and the standard deviation is also 1/lambda and we hopr to get same via simulation. 

## Libraries
```{r}
library(ggplot2)
```

Initialize simulation variables. This is important for reproducibility

```{r init}
set.seed(1)
lambda <- .2
nsims = 1e4
sample_size = 40
```

## Generate a random exponential of 40 with lambda = `0.2`

Now we will simulate an exponential distribution of 1000 with lambda = `0.2` 
with 40 bootstraps

```{r simulation, cache=TRUE}

resamples <- matrix(rexp(nsims*sample_size, rate = lambda), nrow = nsims, ncol = sample_size)
```

### Calculate means of rows in the simulation

```{r samplemean, cache=TRUE}
resamplesMean <- apply(resamples, 1, mean)
```

Let's visualize our sampling distribution and compare it to the `CLT`
```{r}
g <- ggplot(data.frame(x = resamplesMean), aes(x=x))
g = g + geom_histogram(breaks = seq(2,9, .2), col = 'blue', aes(fill = ..count..))
g = g + geom_vline(xintercept = mean(resamplesMean), size = 1, linetype = 'dashed', col = 'red')
g = g+ labs(title = 'Histogram of of Means of Exp', x = 'Sample means', y = 'Frequency')
print(g)
```


### Compare means:
now we will compare the actual mean to the theoretical mean respectively
We can see the actual mean of 5`.002` is close to the theoretical mean of `5.0` calculated below

```{r}
c(mean(resamplesMean), 1/lambda)
```


### Compare variance: 
We can also see the actual variance of `0.626` is closer to the theoretical variance of `0.625 `calculated below
```{r}
c(var(resamplesMean), ((1/lambda)^2)/sample_size)
```


## Show that the distribution is approximately normal

1. use qqplot to check normality
We can infer that the theoretical quantiles is approximately close to the sample quantiles for the plot below 
```{r}
qqnorm(resamplesMean)
qqline(resamplesMean)
```

2. Check `95%` confidence interval if theoretical and actual mean

```{r}
samp_ci <- mean(resamplesMean) + c(-1,1)*1.96*sqrt(var(resamplesMean)/sample_size)
theor_ci <- 1/lambda+ c(-1,1)*1.96*sqrt(( ((1/lambda) ^2) /sample_size)/sample_size)

rbind(samp_ci, theor_ci)
```
We can also infer that the theoretical CI is approximately close to the sample CI 

